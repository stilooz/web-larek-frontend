# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

Проект реализован по принципу **MVP (Model-View-Presenter)**, обеспечивая чёткое разделение ответственности:

- **Model** — загрузка данных по API, сохранение и обработка данных от пользователя.
- **View** — отображение интерфейса и обработка пользовательских событий.
- **Presenter** — реализован с помощью EventEmitter, связывает модели и представления при возникновении событий.

## Модели (Model)

### `ApiModel`

Наследуется от `Api`, взаимодействует с сервером.

**Методы:**

- `getListProductCard()` — получение списка товаров;
- `postOrderLot(data)` — отправка заказа на сервер.

### `BasketModel`

Управление данными корзины.

**Методы:**

- `getCounter()` — количество товаров в корзине;
- `getSumAllProducts()` — сумма всех товаров;
- `setSelectedСard(product)` — добавление товара в корзину;
- `deleteCardToBasket(product)` — удаление товара из корзины;
- `clearBasketProducts()` — очистка корзины.

### `DataModel`

Хранение данных о продуктах.

**Метод:**

- `setPreview(product)` — установка данных выбранного товара.

### `FormModel`

Хранение данных заказа.

**Методы:**

- `setOrderAddress(address, payment)` — установка адреса и способа оплаты;
- `validateOrder()` — валидация адреса и оплаты;
- `setOrderData(email, phone)` — установка контактных данных;
- `validateContacts()` — валидация email и телефона;
- `getOrderLot()` — получение финальных данных заказа.

## Представления (View)

### `Card`

Отображение карточки товара в каталоге.

**Методы:**

- `setText()` — установка текста;
- `cardCategory()` — установка категории;
- `setPrice()` — установка цены.

### `CardPreview`

Наследуется от `Card`, отображает товар в модалке.

**Методы:**

- `notSale()` — отображение состояния недоступности товара;
- `setPrice()`, `cardCategory()`, `setText()` — унаследованы.

### `Basket`

Контейнер корзины.

**Методы:**

- `renderHeaderBasketCounter(count)` — количество товаров в хедере;
- `renderSumAllProducts(sum)` — отображение итоговой суммы.

### `BasketItem`

Отображение одного товара в корзине.

**Методы:**

- `setPrice()` — установка цены.

### `Modal`

Управление модальными окнами.

**Методы:**

- `open(component)` — открытие модалки с компонентом;
- `close()` — закрытие модального окна.

### `Order`

Форма выбора адреса и способа оплаты.

**Методы:**

- `paymentSelection(callback)` — выбор варианта оплаты.

### `Contacts`

Форма ввода email и телефона.

### `Success`

Экран завершения заказа с итогом.

## Презентеры (Presenter)

Презентеры в проекте реализованы с помощью EventEmitter. Основная задача презентеров — обрабатывать события и передавать данные между моделями и представлениями.

## Сценарий работы приложения

1. Загрузка данных из API (`ApiModel`);
2. Передача данных в `DataModel`;
3. Отрисовка карточек в `Card` и `CardPreview`;
4. Клик на карточку — открытие модалки (`Modal`) с `CardPreview`;
5. Клик "В корзину" — передача данных в `BasketModel`, обновление `Basket`;
6. Открытие корзины — рендер `Basket`, `BasketItem`;
7. Клик "Оформить" — открытие `Order`;
8. Выбор способа оплаты и адреса — валидация через `FormModel`;
9. Клик "Далее" — открытие `Contacts`, ввод email и телефона;
10. Клик "Оплатить" — финальная валидация, отправка данных на сервер, очистка корзины;
11. Показ экрана `Success`.
